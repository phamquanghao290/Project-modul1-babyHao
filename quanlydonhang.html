<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Quản lí sản phẩm</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta content="Responsive bootstrap 4 admin template" name="description" />
    <meta content="Coderthemes" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- App favicon -->
    <link
      href="https://img.cdn.vncdn.io/cdn-pos/f8f19b-53936/store/20190718_dMIPi931p7zUMwwzEZleqdMk.png"
      rel="icon"
      type="image/vnd.microsoft.icon"
    />

    <!-- App css -->
    <link
      href="assets\css\bootstrap.min.css"
      rel="stylesheet"
      type="text/css"
      id="bootstrap-stylesheet"
    />
    <link href="assets\css\icons.min.css" rel="stylesheet" type="text/css" />
    <link
      href="assets\css\app.min.css"
      rel="stylesheet"
      type="text/css"
      id="app-stylesheet"
    />
    <link rel="stylesheet" href="./css/admin.css">
  </head>
<body>
    <!-- Begin page -->
    <div id="wrapper">
      <!-- Topbar Start -->
      <div class="navbar-custom" style="background-color: #174195">
        <ul class="list-unstyled topnav-menu float-right mb-0">

            <li class="dropdown notification-list dropdown d-none d-lg-inline-block ml-2">
              
                <div class="dropdown-menu dropdown-menu-right profile-dropdown ">
                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="assets\images\flags\germany.jpg" alt="lang-image" class="mr-1" height="12"> <span class="align-middle">German</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="assets\images\flags\italy.jpg" alt="lang-image" class="mr-1" height="12"> <span class="align-middle">Italian</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="assets\images\flags\spain.jpg" alt="lang-image" class="mr-1" height="12"> <span class="align-middle">Spanish</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="assets\images\flags\russia.jpg" alt="lang-image" class="mr-1" height="12"> <span class="align-middle">Russian</span>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a class="nav-link dropdown-toggle  waves-effect waves-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <i class="mdi mdi-bell-outline noti-icon"></i>
                    <span class="noti-icon-badge"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-lg">

                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h5 class="font-16 text-white m-0">
                            <span class="float-right">
                                <a href="" class="text-white">
                                    <small>Clear All</small>
                                </a>
                            </span>Notification
                        </h5>
                    </div>

                    <!-- All-->
                    <a href="javascript:void(0);" class="dropdown-item text-primary notify-item notify-all">
                        View all
                        <i class="fi-arrow-right"></i>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a class="nav-link dropdown-toggle  waves-effect waves-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <i class="mdi mdi-email-outline noti-icon"></i>
                    <span class="noti-icon-badge"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-lg">

                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h5 class="font-16 text-white m-0">
                            <span class="float-right">
                                <a href="" class="text-white">
                                    <small>Clear All</small>
                                </a>
                            </span>Messages
                        </h5>
                    </div>
                    <!-- All-->
                    <a href="javascript:void(0);" class="dropdown-item text-primary notify-item notify-all">
                        View all
                        <i class="fi-arrow-right"></i>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <div class="dropdown-menu dropdown-menu-right profile-dropdown ">
                    <!-- item-->
                    <div class="dropdown-header noti-title">
                        <h6 class="text-overflow text-white m-0">Welcome !</h6>
                    </div>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="mdi mdi-account-outline"></i>
                        <span>Profile</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="mdi mdi-settings-outline"></i>
                        <span>Settings</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="mdi mdi-lock-outline"></i>
                        <span>Lock Screen</span>
                    </a>

                    <div class="dropdown-divider"></div>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="mdi mdi-logout-variant"></i>
                        <span>Logout</span>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a href="javascript:void(0);" class="nav-link right-bar-toggle waves-effect waves-light">
                    <i class="mdi mdi-settings-outline noti-icon"></i>
                </a>
            </li>

        </ul>

        <!-- LOGO -->
        <div class="logo-box">
            <a href="index.html" class="logo text-center logo-warning" target="_blank">
                <span class="logo-lg">
                    <img src="../img/logo_1616402062_Logo web-01.png" alt="" height="60">
                    <span class="logo-lg-text-warning">FUTURE BOOK</span>
                </span>
                <span class="logo-sm">
                    <!-- <span class="logo-lg-text-dark">U</span> -->
                    <img src="assets\images\logo-sm.png" alt="" height="24">
                </span>
            </a>
        
            <a href="index.html" class="logo text-center logo-light">
                <span class="logo-lg">
                    <img src="assets\images\logo-light.png" alt="" height="22">
                    <!-- <span class="logo-lg-text-dark">Uplon</span> -->
                </span>
                <span class="logo-sm">
                    <!-- <span class="logo-lg-text-dark">U</span> -->
                    <img src="assets\images\logo-sm-light.png" alt="" height="24">
                </span>
            </a>
        </div>
    </div>
      <div class="left-side-menu">
        <div class="slimscroll-menu">
          <!--- Sidemenu -->
          <div class="left-side-menu" style="background-color: #174195;">
            <div class="slimscroll-menu">
              <!--- Sidemenu -->
              <div id="sidebar-menu">
                <ul class="metismenu" id="side-menu">
                  <li class="menu-title" style="color: #fff">Navigation</li>
                  <li>
                    <a href="adminProduct.html">
                      <i class="mdi mdi-view-dashboard" style="color: #fff"></i>
                      <span style="color:#fff; font-weight: 500;"> Quản lí sản phẩm </span>
                    </a>
                  </li>
                    <li>
                    <a href="adminCategory.html">
                        <i class="mdi mdi-view-dashboard" style="color: #fff"></i>
                        <span style="color:#fff; font-weight: 500;"> Quản Lí Phân Loại </span>
                    </a>
                </li>
                  <li>
                    <a href="adminUser.html">
                      <i class="fa-solid fa-user" style="color: #fff"></i>
                      <span  style="color:#fff; font-weight: 500;"> Quản lí người dùng </span>
                    </a>
                  </li>
                  <li>
                    <a href="quanlydonhang.html">
                      <i class="fa-solid fa-cart-shopping" style="color: #fff"></i>
                      <span  style="color:#fff; font-weight: 500;"> Quản lí đơn hàng </span>
                    </a>
                  </li>
                </ul>
              </div>
              <!-- End Sidebar -->
            </div>
            <!-- Sidebar -left -->
          </div>
          <!-- End Sidebar -->
        </div>
        <!-- Sidebar -left -->
      </div>
      <div class="content-page">
        <div class="content">
          <!-- Start Content-->
          <div class="container-fluid">
            <!-- start page title -->
            <div class="row">
              <div class="col-12">
                <div class="page-title-box">
                  <h4 class="page-title" style=" font-size: 50px;">Quản lí đơn hàng</h4>
                </div>
                <div class="donhang">
                    <table style="text-align: center; font-size: 20px" border="1px" cellpadding="10px" cellspacing="10px">
                        <thead>
                            <tr>
                                <th>Id</th>
                                <th>User Mua Hàng</th>
                                <th>Giỏ hàng</th>
                                <th>Tổng Tiền</th>
                                <th>Thời Gian Mua Hàng</th>
                                <th>Trạng Thái</th>
                                <th>Hoạt động</th>
                            </tr>
                        </thead>
                        <tbody id="table_body"></tbody>
                    </table>
                </div>
              </div>
            </div>
          </div>
        </div>
        <footer class="footer">
          <div class="container-fluid">
            <div class="row">
              <div class="col-md-12">
                Quang Hao
              </div>
            </div>
          </div>
        </footer>
      </div>
  </body>
  <script src="../js/quanlydonhang.js"></script>
  <script>
    //     function showOrders() {
    //         let receive = JSON.parse(localStorage.getItem("receive"));
    //         if (receive == null) {
    //             console.log("Không có đơn hàng.");
    //             return;
    //         };
    //         let result = `
    //                     <tr class="tr1">
    //                         <td class="td1">ID</td>
    //                         <td class="td1">ID đơn hàng</td>
    //                         <td class="td1">Username</td>
    //                         <td class="td1">Tên người nhận</td>
    //                         <td class="td1">Địa chỉ</td>
    //                         <td class="td1">Sản phẩm mua</td>
    //                         <td class="td1">Số tiền thanh toán</td>
    //                         <td class="td1">Trạng thái</td>
    //                     </tr>
    //         `;
    //         for (let i = 0; i < receive.length; i++) {
    //             const cartItems = JSON.parse(localStorage.getItem("listProductCart")).filter(item => item.username === receive[i].email);
    //             const productNames = cartItems.map(item => item.ten);
    //             const productNameString = productNames.join(" <br> ");
    //             result += `
    //                     <tr class="tr1">
    //                         <td class="td1">${i+1}</td>
    //                         <td class="td1">${receive[i].ID}</td>
    //                         <td class="td1">${receive[i].email}</td>
    //                         <td class="td1">${receive[i].tennguoinhan}</td>
    //                         <td class="td1">${receive[i].diachi}</td>
    //                         <td class="td1">${productNameString}</td>
    //                         <td class="td1">${receive[i].money}</td>
    //                         <td class="td1">
    //                             <select name="" id="">
    //                                 <option value="">Chờ xác nhận</option>
    //                                 <option value="">Đang vận chuyển</option>
    //                                 <option value="">Hoàn thành</option>
    //                             </select>
    //                         </td>
    //                     </tr>
    //             `
    //         }
    //         document.getElementById("tableAdded").innerHTML = result;
    // }
    // showOrders();
//     function showOrders() {
//     let receive = JSON.parse(localStorage.getItem("receive"));
//     if (receive == null) {
//         console.log("Không có đơn hàng.");
//         return;
//     }

//     let result = `
//             <tr class="tr1">
//                 <td class="td1">ID</td>
//                 <td class="td1">ID đơn hàng</td>
//                 <td class="td1">Username</td>
//                 <td class="td1">Tên người nhận</td>
//                 <td class="td1">Địa chỉ</td>
//                 <td class="td1">Sản phẩm mua</td>
//                 <td class="td1">Số tiền thanh toán</td>
//                 <td class="td1">Trạng thái</td>
//             </tr>
//         `;
    
//     const listProductCart = JSON.parse(localStorage.getItem("listProductCart"));
//     const flaguser = localStorage.getItem("flaguser");

//     for (let i = 0; i < listProductCart.length; i++) {
//         const orderId = listProductCart[i].orderId;

//         const infoReceive = receive.filter(
//         (item) => item.email === flaguser && item.ID === orderId
//         );

//         if (infoReceive.length > 0) {
//         const productNames = listProductCart
//             .filter((item) => item.username === flaguser && item.orderId === orderId)
//             .map((item) => item.ten);
//         const productNameString = productNames.join(" <br> ");
//         result += `
//                     <tr class="tr1">
//                         <td class="td1">${i + 1}</td>
//                         <td class="td1">${orderId}</td>
//                         <td class="td1">${flaguser}</td>
//                         <td class="td1">${infoReceive[0].tennguoinhan}</td>
//                         <td class="td1">${infoReceive[0].diachi}</td>
//                         <td class="td1">${productNameString}</td>
//                         <td class="td1">${infoReceive[0].money}</td>
//                         <td class="td1">
//                             <select name="" id="">
//                                 <option value="">Chờ xác nhận</option>
//                                 <option value="">Đang vận chuyển</option>
//                                 <option value="">Hoàn thành</option>
//                             </select>
//                         </td>
//                     </tr>
//                 `;
//         }
//     }

//     document.getElementById("tableAdded").innerHTML = result;
// }
// showOrders()
// function showOrders() {
//     let receive = JSON.parse(localStorage.getItem("receive"));
//     if (receive == null) {
//         console.log("Không có đơn hàng.");
//         return;
//     }

//     let result = `
//             <tr class="tr1">
//                 <td class="td1">ID</td>
//                 <td class="td1">ID đơn hàng</td>
//                 <td class="td1">Username</td>
//                 <td class="td1">Tên người nhận</td>
//                 <td class="td1">Địa chỉ</td>
//                 <td class="td1">Sản phẩm mua</td>
//                 <td class="td1">Số tiền thanh toán</td>
//                 <td class="td1">Trạng thái</td>
//             </tr>
//         `;
    
//     const listProductCart = JSON.parse(localStorage.getItem("listProductCart"));
//     const flaguser = localStorage.getItem("flaguser");

//     let count = 0;
//     for (let i = 0; i < receive.length; i++) {
//         if (receive[i].email === flaguser) {
//             const orderId = receive[i].ID;

//             const productNames = listProductCart
//                 .filter((item) => item.username === flaguser && item.orderId === orderId)
//                 .map((item) => item.ten);
//             const productNameString = productNames.join(" <br> ");
//             result += `
//                     <tr class="tr1">
//                         <td class="td1">${++count}</td>
//                         <td class="td1">${orderId}</td>
//                         <td class="td1">${flaguser}</td>
//                         <td class="td1">${receive[i].tennguoinhan}</td>
//                         <td class="td1">${receive[i].diachi}</td>
//                         <td class="td1">${productNameString}</td>
//                         <td class="td1">${receive[i].money}</td>
//                         <td class="td1">
//                             <select name="" id="">
//                                 <option value="">Chờ xác nhận</option>
//                                 <option value="">Đang vận chuyển</option>
//                                 <option value="">Hoàn thành</option>
//                             </select>
//                         </td>
//                     </tr>
//                 `;
//         }
//     }

//     document.getElementById("tableAdded").innerHTML = result;
// }
// showOrders();
// function showOrders() {
//     let receive = JSON.parse(localStorage.getItem("receive"));
//     if (receive == null) {
//         console.log("Không có đơn hàng.");
//         return;
//     }

//     let result = `
//             <tr class="tr1">
//                 <td class="td1">ID</td>
//                 <td class="td1">ID đơn hàng</td>
//                 <td class="td1">Username</td>
//                 <td class="td1">Tên người nhận</td>
//                 <td class="td1">Địa chỉ</td>
//                 <td class="td1">Sản phẩm mua</td>
//                 <td class="td1">Số tiền thanh toán</td>
//                 <td class="td1">Trạng thái</td>
//             </tr>
//         `;
    
//     const flaguser = localStorage.getItem("flaguser");

//     let count = 0;
//     for (let i = 0; i < receive.length; i++) {
//         if (receive[i].email === flaguser) {
//             const orderId = receive[i].ID;

//             // Lấy danh sách sản phẩm từ localStorage hoặc đệm nếu đã được lưu trữ trước đó
//             let products;
//             const cachedProducts = localStorage.getItem(`products-${orderId}`);
//             if (cachedProducts) {
//                 products = JSON.parse(cachedProducts);
//             } else {
//                 products = JSON.parse(localStorage.getItem("listProductCart")).filter(
//                     (item) => item.username === flaguser && item.orderId === orderId
//                 );
//                 localStorage.setItem(`products-${orderId}`, JSON.stringify(products));
//             }

//             const productNames = products.map((item) => item.ten);
//             const productNameString = productNames.join(" <br> ");
//             result += `
//                     <tr class="tr1">
//                         <td class="td1">${++count}</td>
//                         <td class="td1">${orderId}</td>
//                         <td class="td1">${flaguser}</td>
//                         <td class="td1">${receive[i].tennguoinhan}</td>
//                         <td class="td1">${receive[i].diachi}</td>
//                         <td class="td1">${productNameString}</td>
//                         <td class="td1">${receive[i].money}</td>
//                         <td class="td1">
//                             <select name="" id="">
//                                 <option value="">Chờ xác nhận</option>
//                                 <option value="">Đang vận chuyển</option>
//                                 <option value="">Hoàn thành</option>
//                             </select>
//                         </td>
//                     </tr>
//                 `;
//         }
//     }

//     document.getElementById("tableAdded").innerHTML = result;
// }
// showOrders();
function showOrder() {
// Lấy thông tin đơn hàng từ localStorage
const receive = JSON.parse(localStorage.getItem('receive'));

if (receive == null) {
console.log('Không có đơn hàng.');
return;
}

let result =    `<tr class="tr1">
               <td class="td1">ID</td>   
                <td class="td1">ID đơn hàng</td>   
                <td class="td1">Username</td> 
                <td class="td1">Số điện thoại</td> 
                 <td class="td1">Tên người nhận</td>     
                <td class="td1">Địa chỉ</td>        
                <td class="td1">Sản phẩm mua</td>        
             <td class="td1">Số tiền thanh toán</td>   
                <td class="td1">Trạng thái</td>
              </tr> ` ;

let count = 0;
for (let i = 0; i < receive.length; i++) {
const orderId = receive[i].ID;

// Lấy danh sách sản phẩm từ localStorage hoặc đệm nếu đã được lưu trữ trước đó
let products;
const cachedProducts = localStorage.getItem(`products-${orderId}`);
if (cachedProducts) {
  products = JSON.parse(cachedProducts);
} else {
  products = JSON.parse(localStorage.getItem('listProductCart')).filter(
    item => item.orderId === orderId
  );
  localStorage.setItem(`products-${orderId}`, JSON.stringify(products));
}

const productNames = products.map(item => item.ten);
const productNameString = productNames.join(' <br> ');
result += `
    <tr class="tr1">
        <td class="td1">${++count}</td>
        <td class="td1">${orderId}</td>
        <td class="td1">${receive[i].email}</td>
        <td class="td1">${receive[i].tennguoinhan}</td>
        <td class="td1">${receive[i].sdt}</td>
        <td class="td1">${receive[i].diachi}</td>
        <td class="td1">${productNameString}</td>
        <td class="td1">${receive[i].money}</td>
        <td class="td1">
            <select name="" id="">
                <option value="">Chờ xác nhận</option>
                <option value="">Đang vận chuyển</option>
                <option value="">Hoàn thành</option>
            </select>
        </td>
    </tr>
`;
}

document.getElementById('tableAdded').innerHTML = result;
}
showOrder()
  </script>
</html>